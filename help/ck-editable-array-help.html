<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ck-editable-array Documentation</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
    }

    .doc-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 260px;
      background: #2c3e50;
      color: #ecf0f1;
      padding: 2rem 0;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    .sidebar-title {
      font-size: 1.25rem;
      font-weight: bold;
      padding: 0 1.5rem 1rem;
      color: #fff;
      border-bottom: 1px solid #34495e;
      margin-bottom: 1rem;
    }

    .sidebar nav {
      padding: 0;
    }

    .sidebar nav a {
      display: block;
      padding: 0.6rem 1.5rem;
      color: #ecf0f1;
      text-decoration: none;
      transition: all 0.2s;
      border-left: 3px solid transparent;
    }

    .sidebar nav a:hover {
      background: #34495e;
      border-left-color: #3498db;
    }

    .sidebar nav a.active {
      background: #34495e;
      border-left-color: #3498db;
      color: #fff;
    }

    /* Main Content Styles */
    .main-content {
      flex: 1;
      padding: 2rem 3rem;
      background: #fff;
      max-width: calc(100% - 260px);
    }

    header {
      border-bottom: 3px solid #3498db;
      padding-bottom: 1.5rem;
      margin-bottom: 2rem;
    }

    h1 {
      font-size: 2.5rem;
      color: #2c3e50;
      margin-bottom: 0.5rem;
    }

    .lead {
      font-size: 1.25rem;
      color: #7f8c8d;
    }

    h2 {
      font-size: 1.75rem;
      color: #2c3e50;
      margin-top: 2.5rem;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #ecf0f1;
    }

    h3 {
      font-size: 1.35rem;
      color: #34495e;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
    }

    section {
      margin-bottom: 3rem;
    }

    p {
      margin-bottom: 1rem;
    }

    ul, ol {
      margin-bottom: 1rem;
      padding-left: 2rem;
    }

    li {
      margin-bottom: 0.5rem;
    }

    code {
      background: #f8f9fa;
      padding: 0.2rem 0.4rem;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      color: #e74c3c;
    }

    pre {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 1.5rem;
      border-radius: 5px;
      overflow-x: auto;
      margin-bottom: 1.5rem;
      line-height: 1.5;
    }

    pre code {
      background: none;
      color: inherit;
      padding: 0;
      font-size: 0.95em;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1.5rem;
      border: 1px solid #ddd;
    }

    th, td {
      padding: 0.75rem;
      text-align: left;
      border: 1px solid #ddd;
    }

    th {
      background: #3498db;
      color: #fff;
      font-weight: 600;
    }

    tr:nth-child(even) {
      background: #f8f9fa;
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 0.6rem;
      font-size: 0.85rem;
      font-weight: 600;
      border-radius: 3px;
      margin-left: 0.5rem;
    }

    .badge-required {
      background: #e74c3c;
      color: #fff;
    }

    .badge-optional {
      background: #95a5a6;
      color: #fff;
    }

    .alert {
      padding: 1rem;
      border-radius: 5px;
      margin-bottom: 1.5rem;
      border-left: 4px solid;
    }

    .alert-info {
      background: #d1ecf1;
      border-color: #0c5460;
      color: #0c5460;
    }

    .alert-warning {
      background: #fff3cd;
      border-color: #856404;
      color: #856404;
    }

    .example-link {
      display: inline-block;
      padding: 0.5rem 1rem;
      background: #3498db;
      color: #fff;
      text-decoration: none;
      border-radius: 4px;
      margin: 0.25rem;
      transition: background 0.2s;
    }

    .example-link:hover {
      background: #2980b9;
    }

    .framework-section {
      background: #f8f9fa;
      padding: 1.5rem;
      border-radius: 5px;
      margin-bottom: 1.5rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .doc-container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }

      .main-content {
        max-width: 100%;
        padding: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="doc-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="sidebar-title">ck-editable-array</div>
      <nav>
        <a href="#overview">Overview</a>
        <a href="#installation">Installation & Setup</a>
        <a href="#basic-usage">Basic Usage</a>
        <a href="#attributes">Attributes & Options</a>
        <a href="#properties">Properties</a>
        <a href="#methods">Methods</a>
        <a href="#events">Events</a>
        <a href="#templates">Templates & Slots</a>
        <a href="#css">CSS & Theming</a>
        <a href="#validation">Validation</a>
        <a href="#frameworks">Using with Frameworks</a>
        <a href="#examples">Examples</a>
        <a href="#accessibility">Accessibility</a>
        <a href="#faq">FAQ</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <header>
        <h1>ck-editable-array</h1>
        <p class="lead">A flexible, accessible editable array/list web component with inline and modal editing modes</p>
      </header>

      <!-- Overview -->
      <section id="overview">
        <h2>Overview</h2>
        <p>
          <code>&lt;ck-editable-array&gt;</code> is a custom web component that provides a powerful solution for managing
          editable lists of data. It supports full CRUD operations (Create, Read, Update, Delete), inline or modal editing
          modes, schema-based validation, and soft-delete functionality with restore capabilities.
        </p>
        <h3>Key Features</h3>
        <ul>
          <li><strong>CRUD Operations:</strong> Add, edit, save, cancel, delete, and restore rows</li>
          <li><strong>Dual Edit Modes:</strong> Choose between inline editing or modal dialog editing</li>
          <li><strong>Template-Based:</strong> Fully customizable display and edit templates</li>
          <li><strong>Validation:</strong> Built-in schema-based validation with field-level error feedback</li>
          <li><strong>Soft Delete:</strong> Delete items without permanent removal, with restore capability</li>
          <li><strong>Immutable Data:</strong> Deep cloning ensures data integrity</li>
          <li><strong>Accessibility:</strong> Full ARIA support for screen readers</li>
          <li><strong>Framework Agnostic:</strong> Works with Razor, React, Angular, Blazor, and vanilla JavaScript</li>
        </ul>
        <h3>Component Category</h3>
        <p>Form control / Data display</p>
      </section>

      <!-- Installation -->
      <section id="installation">
        <h2>Installation & Setup</h2>

        <h3>Via GitHub Packages</h3>
        <p>First, configure npm to use GitHub Packages. Create or update your <code>.npmrc</code> file:</p>
        <pre><code>@colmkenna:registry=https://npm.pkg.github.com
//npm.pkg.github.com/:_authToken=YOUR_GITHUB_TOKEN</code></pre>

        <p>Then install the package:</p>
        <pre><code>npm install @colmkenna/ck-webcomponents</code></pre>

        <h3>Via CDN</h3>
        <pre><code>&lt;script src="https://unpkg.com/@colmkenna/ck-webcomponents@latest/dist/ck-editable-array/ck-editable-array.min.js"&gt;&lt;/script&gt;</code></pre>

        <h3>Via ES Module Import</h3>
        <pre><code>import '@colmkenna/ck-webcomponents';</code></pre>

        <h3>Local Development</h3>
        <pre><code>&lt;script type="module" src="./dist/ck-editable-array/ck-editable-array.esm.js"&gt;&lt;/script&gt;</code></pre>
      </section>

      <!-- Basic Usage -->
      <section id="basic-usage">
        <h2>Basic Usage</h2>
        <p>To use the component, include it in your HTML and provide display and edit templates:</p>
        <pre><code>&lt;ck-editable-array id="myList"&gt;
  &lt;template data-slot="display"&gt;
    &lt;div&gt;
      &lt;strong data-bind="name"&gt;&lt;/strong&gt;
      &lt;span data-bind="email"&gt;&lt;/span&gt;
      &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
      &lt;button data-action="delete"&gt;Delete&lt;/button&gt;
    &lt;/div&gt;
  &lt;/template&gt;

  &lt;template data-slot="edit"&gt;
    &lt;div&gt;
      &lt;input type="text" data-bind="name"&gt;
      &lt;input type="email" data-bind="email"&gt;
      &lt;button data-action="save"&gt;Save&lt;/button&gt;
      &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
  &lt;/template&gt;
&lt;/ck-editable-array&gt;

&lt;script&gt;
  const list = document.getElementById('myList');

  // Set initial data
  list.data = [
    { name: 'Alice', email: 'alice@example.com' },
    { name: 'Bob', email: 'bob@example.com' }
  ];

  // Configure new item factory
  list.newItemFactory = () => ({ name: '', email: '' });
&lt;/script&gt;</code></pre>
      </section>

      <!-- Attributes -->
      <section id="attributes">
        <h2>Attributes & Options</h2>
        <table>
          <thead>
            <tr>
              <th>Attribute</th>
              <th>Type</th>
              <th>Default</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>"World"</td>
              <td>Component instance name, used for generating form field names</td>
            </tr>
            <tr>
              <td><code>color</code></td>
              <td>string</td>
              <td>"#333"</td>
              <td>Custom color for styling (CSS color value)</td>
            </tr>
            <tr>
              <td><code>readonly</code></td>
              <td>boolean</td>
              <td>false</td>
              <td>When set, prevents all editing operations</td>
            </tr>
            <tr>
              <td><code>modal-edit</code></td>
              <td>boolean</td>
              <td>false</td>
              <td>Enables modal dialog editing instead of inline editing</td>
            </tr>
          </tbody>
        </table>

        <h3>Example Usage</h3>
        <pre><code>&lt;!-- Read-only mode --&gt;
&lt;ck-editable-array readonly&gt;&lt;/ck-editable-array&gt;

&lt;!-- Modal editing mode --&gt;
&lt;ck-editable-array modal-edit&gt;&lt;/ck-editable-array&gt;

&lt;!-- Custom name and color --&gt;
&lt;ck-editable-array name="users" color="#3498db"&gt;&lt;/ck-editable-array&gt;</code></pre>
      </section>

      <!-- Properties -->
      <section id="properties">
        <h2>Properties</h2>
        <table>
          <thead>
            <tr>
              <th>Property</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>data</code></td>
              <td>Array&lt;Record&lt;string, unknown&gt;&gt;</td>
              <td>Array of data objects to display and edit. Returns a deep clone to ensure immutability.</td>
            </tr>
            <tr>
              <td><code>newItemFactory</code></td>
              <td>() =&gt; Record&lt;string, unknown&gt;</td>
              <td>Factory function that creates new items when adding a row. Should return an object with default values.</td>
            </tr>
            <tr>
              <td><code>validationSchema</code></td>
              <td>Object</td>
              <td>Validation rules for form fields. See <a href="#validation">Validation</a> section for details.</td>
            </tr>
            <tr>
              <td><code>readonly</code></td>
              <td>boolean</td>
              <td>Get/set readonly mode programmatically</td>
            </tr>
            <tr>
              <td><code>modalEdit</code></td>
              <td>boolean</td>
              <td>Get/set modal editing mode programmatically</td>
            </tr>
          </tbody>
        </table>

        <h3>Example Usage</h3>
        <pre><code>const list = document.querySelector('ck-editable-array');

// Set data
list.data = [
  { id: 1, name: 'Item 1' },
  { id: 2, name: 'Item 2' }
];

// Configure factory
list.newItemFactory = () => ({
  id: Date.now(),
  name: '',
  createdAt: new Date()
});

// Get current data (returns a deep clone)
const currentData = list.data;
console.log(currentData);</code></pre>
      </section>

      <!-- Methods -->
      <section id="methods">
        <h2>Methods</h2>
        <table>
          <thead>
            <tr>
              <th>Method</th>
              <th>Parameters</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>addRow()</code></td>
              <td>None</td>
              <td>Adds a new row using the newItemFactory and enters edit mode automatically</td>
            </tr>
            <tr>
              <td><code>deleteRow(index)</code></td>
              <td>index: number</td>
              <td>Soft-deletes a row by setting its deleted flag to true</td>
            </tr>
            <tr>
              <td><code>restoreRow(index)</code></td>
              <td>index: number</td>
              <td>Restores a soft-deleted row by setting its deleted flag to false</td>
            </tr>
          </tbody>
        </table>

        <div class="alert alert-info">
          <strong>Note:</strong> Internal methods like <code>enterEditMode()</code>, <code>saveRow()</code>, and
          <code>cancelEdit()</code> are triggered through template action buttons and are not meant to be called directly.
        </div>

        <h3>Example Usage</h3>
        <pre><code>const list = document.querySelector('ck-editable-array');

// Add a new row
list.addRow();

// Delete row at index 0
list.deleteRow(0);

// Restore row at index 0
list.restoreRow(0);</code></pre>
      </section>

      <!-- Events -->
      <section id="events">
        <h2>Events</h2>
        <table>
          <thead>
            <tr>
              <th>Event Name</th>
              <th>When Fired</th>
              <th>Event Detail</th>
              <th>Cancelable</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>datachanged</code></td>
              <td>When data is modified (add, delete, restore, or save)</td>
              <td><code>{ data: Array }</code></td>
              <td>No</td>
            </tr>
            <tr>
              <td><code>beforetogglemode</code></td>
              <td>Before entering or exiting edit mode</td>
              <td><code>{ index: number, editing: boolean }</code></td>
              <td>Yes</td>
            </tr>
            <tr>
              <td><code>aftertogglemode</code></td>
              <td>After entering or exiting edit mode</td>
              <td><code>{ index: number, editing: boolean }</code></td>
              <td>No</td>
            </tr>
          </tbody>
        </table>

        <h3>Example Event Listeners</h3>
        <pre><code>const list = document.querySelector('ck-editable-array');

// Listen for data changes
list.addEventListener('datachanged', (e) => {
  console.log('Data changed:', e.detail.data);
  // Save to server, update UI, etc.
});

// Prevent entering edit mode (validation example)
list.addEventListener('beforetogglemode', (e) => {
  if (e.detail.editing && !userHasPermission()) {
    e.preventDefault(); // Cancel the mode change
    alert('You do not have permission to edit');
  }
});

// Track when edit mode is activated
list.addEventListener('aftertogglemode', (e) => {
  console.log(`Row ${e.detail.index} is now ${e.detail.editing ? 'editing' : 'displaying'}`);
});</code></pre>
      </section>

      <!-- Templates -->
      <section id="templates">
        <h2>Templates & Slots</h2>
        <p>
          The component uses two templates for rendering: one for display mode and one for edit mode.
          These are defined as child <code>&lt;template&gt;</code> elements with specific <code>data-slot</code> attributes.
        </p>

        <h3>Display Template</h3>
        <p>Used when a row is in display (non-editing) mode.</p>
        <pre><code>&lt;template data-slot="display"&gt;
  &lt;div class="row-item"&gt;
    &lt;!-- data-bind: binds to data properties --&gt;
    &lt;strong data-bind="name"&gt;&lt;/strong&gt;
    &lt;span data-bind="email"&gt;&lt;/span&gt;

    &lt;!-- data-action: triggers component actions --&gt;
    &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
    &lt;button data-action="delete"&gt;Delete&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;</code></pre>

        <h3>Edit Template</h3>
        <p>Used when a row is in edit mode (or in the modal dialog if modal-edit is enabled).</p>
        <pre><code>&lt;template data-slot="edit"&gt;
  &lt;div class="edit-panel"&gt;
    &lt;!-- Form inputs with data-bind --&gt;
    &lt;label&gt;
      Name:
      &lt;input type="text" data-bind="name"&gt;
      &lt;span data-field-error="name"&gt;&lt;/span&gt;
    &lt;/label&gt;

    &lt;label&gt;
      Email:
      &lt;input type="email" data-bind="email"&gt;
      &lt;span data-field-error="email"&gt;&lt;/span&gt;
    &lt;/label&gt;

    &lt;!-- Save and cancel actions --&gt;
    &lt;button data-action="save"&gt;Save&lt;/button&gt;
    &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;</code></pre>

        <h3>Data Binding Attributes</h3>
        <table>
          <thead>
            <tr>
              <th>Attribute</th>
              <th>Purpose</th>
              <th>Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>data-bind</code></td>
              <td>Binds element to a data property. Supports dot notation for nested properties.</td>
              <td><code>&lt;span data-bind="user.address.city"&gt;&lt;/span&gt;</code></td>
            </tr>
            <tr>
              <td><code>data-action</code></td>
              <td>Specifies action button type: toggle, save, cancel, delete, restore, add</td>
              <td><code>&lt;button data-action="save"&gt;Save&lt;/button&gt;</code></td>
            </tr>
            <tr>
              <td><code>data-field-error</code></td>
              <td>Container for displaying validation errors for a specific field</td>
              <td><code>&lt;span data-field-error="email"&gt;&lt;/span&gt;</code></td>
            </tr>
            <tr>
              <td><code>data-error-summary</code></td>
              <td>Container for displaying all validation errors for a row</td>
              <td><code>&lt;div data-error-summary&gt;&lt;/div&gt;</code></td>
            </tr>
          </tbody>
        </table>

        <h3>Available Actions</h3>
        <ul>
          <li><code>toggle</code> - Enter edit mode for a row</li>
          <li><code>save</code> - Save changes to the current row</li>
          <li><code>cancel</code> - Cancel editing and restore original data</li>
          <li><code>delete</code> - Soft-delete a row</li>
          <li><code>restore</code> - Restore a soft-deleted row</li>
          <li><code>add</code> - Add a new row (global action, not row-specific)</li>
        </ul>
      </section>

      <!-- CSS -->
      <section id="css">
        <h2>CSS & Theming</h2>

        <h3>Shadow DOM</h3>
        <p>
          The component uses Shadow DOM for style encapsulation. Styles are shipped with the component using
          adopted stylesheets where supported, with a fallback for older browsers.
        </p>

        <h3>CSS Custom Properties</h3>
        <p>Customize the component appearance using CSS custom properties (CSS variables):</p>
        <table>
          <thead>
            <tr>
              <th>Variable</th>
              <th>Description</th>
              <th>Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>--ck-editable-array-color</code></td>
              <td>Text color for the component</td>
              <td>#333</td>
            </tr>
          </tbody>
        </table>

        <h3>Styling Templates</h3>
        <p>Since templates are slotted into Shadow DOM, you can include stylesheets in your templates:</p>
        <pre><code>&lt;template data-slot="display"&gt;
  &lt;link rel="stylesheet" href="your-styles.css"&gt;
  &lt;div class="your-custom-class"&gt;
    ...
  &lt;/div&gt;
&lt;/template&gt;</code></pre>

        <h3>Component State Classes</h3>
        <ul>
          <li><code>.ck-deleted</code> - Applied to soft-deleted rows (opacity: 0.5, text-decoration: line-through)</li>
          <li><code>.ck-hidden</code> - Applied to hidden modal overlay</li>
          <li><code>[data-row-invalid]</code> - Applied to rows with validation errors</li>
          <li><code>[data-invalid]</code> - Applied to individual form inputs with validation errors</li>
        </ul>

        <h3>Layout Integration</h3>
        <p>
          The component uses <code>display: block</code> by default. It will fill the width of its container.
          Use standard CSS to control sizing:
        </p>
        <pre><code>ck-editable-array {
  max-width: 800px;
  margin: 0 auto;
}</code></pre>
      </section>

      <!-- Validation -->
      <section id="validation">
        <h2>Validation</h2>
        <p>
          The component includes built-in schema-based validation. Define validation rules using the
          <code>validationSchema</code> property.
        </p>

        <h3>Validation Rules</h3>
        <table>
          <thead>
            <tr>
              <th>Rule</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>required</code></td>
              <td>boolean</td>
              <td>Field must have a non-empty value</td>
            </tr>
            <tr>
              <td><code>minLength</code></td>
              <td>number</td>
              <td>Minimum string length</td>
            </tr>
            <tr>
              <td><code>maxLength</code></td>
              <td>number</td>
              <td>Maximum string length</td>
            </tr>
            <tr>
              <td><code>pattern</code></td>
              <td>RegExp</td>
              <td>Value must match the regular expression</td>
            </tr>
            <tr>
              <td><code>custom</code></td>
              <td>Function</td>
              <td>Custom validation function: <code>(value, row) => boolean</code></td>
            </tr>
          </tbody>
        </table>

        <h3>Example Validation Schema</h3>
        <pre><code>const list = document.querySelector('ck-editable-array');

list.validationSchema = {
  username: {
    required: true,
    minLength: 3,
    maxLength: 20,
    pattern: /^[a-zA-Z0-9_]+$/,
  },
  email: {
    required: true,
    pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
    custom: (value) => {
      // Custom validation: block certain domains
      return !value.endsWith('@blocked.com');
    }
  },
  age: {
    custom: (value) => {
      const age = parseInt(value);
      return age >= 18 && age <= 120;
    }
  }
};</code></pre>

        <h3>Validation Feedback</h3>
        <p>Add error display elements to your edit template:</p>
        <pre><code>&lt;template data-slot="edit"&gt;
  &lt;!-- Row-level error summary --&gt;
  &lt;div data-error-summary class="error-summary"&gt;&lt;/div&gt;

  &lt;label&gt;
    Username:
    &lt;input type="text" data-bind="username"&gt;
    &lt;!-- Field-level error display --&gt;
    &lt;span data-field-error="username" class="field-error"&gt;&lt;/span&gt;
  &lt;/label&gt;

  &lt;button data-action="save"&gt;Save&lt;/button&gt;
&lt;/template&gt;</code></pre>

        <div class="alert alert-info">
          <strong>Validation Behavior:</strong> The Save button is automatically disabled when validation errors exist.
          Validation runs in real-time as the user types (with 150ms debounce).
        </div>
      </section>

      <!-- Frameworks -->
      <section id="frameworks">
        <h2>Using with Frameworks</h2>

        <div class="framework-section">
          <h3>Razor (ASP.NET MVC / Razor Pages)</h3>
          <p>Include the component script and use it directly in your Razor views:</p>
          <pre><code>@* In _Layout.cshtml or your view *@
&lt;script type="module" src="~/dist/ck-editable-array/ck-editable-array.esm.js"&gt;&lt;/script&gt;

@* In your view *@
&lt;ck-editable-array id="userList"&gt;
  &lt;template data-slot="display"&gt;
    &lt;div&gt;
      &lt;span data-bind="name"&gt;&lt;/span&gt;
      &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/template&gt;

  &lt;template data-slot="edit"&gt;
    &lt;div&gt;
      &lt;input type="text" data-bind="name"&gt;
      &lt;button data-action="save"&gt;Save&lt;/button&gt;
      &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
  &lt;/template&gt;
&lt;/ck-editable-array&gt;

@section Scripts {
  &lt;script&gt;
    document.addEventListener('DOMContentLoaded', () => {
      const list = document.getElementById('userList');
      list.data = @Html.Raw(Json.Serialize(Model.Users));
      list.newItemFactory = () => ({ name: '', email: '' });
    });
  &lt;/script&gt;
}</code></pre>
        </div>

        <div class="framework-section">
          <h3>Blazor</h3>
          <p>Add the script reference to your <code>_Host.cshtml</code> or <code>index.html</code>:</p>
          <pre><code>&lt;!-- In _Host.cshtml or index.html --&gt;
&lt;script type="module" src="_content/YourApp/ck-editable-array.esm.js"&gt;&lt;/script&gt;</code></pre>

          <p>Use the component in your Razor component:</p>
          <pre><code>@page "/users"
@inject IJSRuntime JS

&lt;ck-editable-array @ref="listElement"&gt;
  &lt;template data-slot="display"&gt;
    &lt;div&gt;
      &lt;span data-bind="name"&gt;&lt;/span&gt;
      &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/template&gt;

  &lt;template data-slot="edit"&gt;
    &lt;div&gt;
      &lt;input type="text" data-bind="name"&gt;
      &lt;button data-action="save"&gt;Save&lt;/button&gt;
      &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
  &lt;/template&gt;
&lt;/ck-editable-array&gt;

@code {
    private ElementReference listElement;
    private List&lt;User&gt; users = new();

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("eval", @"
                document.querySelector('ck-editable-array').data = " +
                System.Text.Json.JsonSerializer.Serialize(users) + @";
                document.querySelector('ck-editable-array').newItemFactory = () => ({ name: '', email: '' });
            ");
        }
    }
}</code></pre>
        </div>

        <div class="framework-section">
          <h3>React</h3>
          <p>Import the component and use it with refs for data binding:</p>
          <pre><code>import React, { useRef, useEffect } from 'react';
import '@colmkenna/ck-webcomponents';

function UserList() {
  const listRef = useRef(null);

  useEffect(() => {
    if (listRef.current) {
      // Set initial data
      listRef.current.data = [
        { name: 'Alice', email: 'alice@example.com' },
        { name: 'Bob', email: 'bob@example.com' }
      ];

      // Configure factory
      listRef.current.newItemFactory = () => ({
        name: '',
        email: ''
      });

      // Listen for changes
      const handleDataChange = (e) => {
        console.log('Data changed:', e.detail.data);
      };

      listRef.current.addEventListener('datachanged', handleDataChange);

      return () => {
        listRef.current?.removeEventListener('datachanged', handleDataChange);
      };
    }
  }, []);

  return (
    &lt;ck-editable-array ref={listRef}&gt;
      &lt;template data-slot="display"&gt;
        &lt;div&gt;
          &lt;span data-bind="name"&gt;&lt;/span&gt;
          &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
        &lt;/div&gt;
      &lt;/template&gt;

      &lt;template data-slot="edit"&gt;
        &lt;div&gt;
          &lt;input type="text" data-bind="name" /&gt;
          &lt;button data-action="save"&gt;Save&lt;/button&gt;
          &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
        &lt;/div&gt;
      &lt;/template&gt;
    &lt;/ck-editable-array&gt;
  );
}

export default UserList;</code></pre>
        </div>

        <div class="framework-section">
          <h3>Angular</h3>
          <p>Configure Angular to recognize custom elements in <code>app.module.ts</code>:</p>
          <pre><code>import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';

@NgModule({
  // ... other config
  schemas: [CUSTOM_ELEMENTS_SCHEMA]
})
export class AppModule { }</code></pre>

          <p>Import the component in your component TypeScript file:</p>
          <pre><code>import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';
import '@colmkenna/ck-webcomponents';

@Component({
  selector: 'app-user-list',
  template: `
    &lt;ck-editable-array #listElement&gt;
      &lt;template data-slot="display"&gt;
        &lt;div&gt;
          &lt;span data-bind="name"&gt;&lt;/span&gt;
          &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
        &lt;/div&gt;
      &lt;/template&gt;

      &lt;template data-slot="edit"&gt;
        &lt;div&gt;
          &lt;input type="text" data-bind="name"&gt;
          &lt;button data-action="save"&gt;Save&lt;/button&gt;
          &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
        &lt;/div&gt;
      &lt;/template&gt;
    &lt;/ck-editable-array&gt;
  `
})
export class UserListComponent implements OnInit {
  @ViewChild('listElement') listElement!: ElementRef;

  ngOnInit() {
    const list = this.listElement.nativeElement;

    list.data = [
      { name: 'Alice', email: 'alice@example.com' },
      { name: 'Bob', email: 'bob@example.com' }
    ];

    list.newItemFactory = () => ({ name: '', email: '' });

    list.addEventListener('datachanged', (e: any) => {
      console.log('Data changed:', e.detail.data);
    });
  }
}</code></pre>
        </div>
      </section>

      <!-- Examples -->
      <section id="examples">
        <h2>Examples</h2>
        <p>Explore these runnable example files to see the component in action:</p>

        <h3>Basic Examples</h3>
        <p>
          <a href="ck-editable-array-example-basic.html" class="example-link">Basic CRUD Example</a>
          <a href="ck-editable-array-example-advanced.html" class="example-link">Advanced Example with Validation</a>
        </p>

        <h3>Framework Examples</h3>
        <p>
          <a href="ck-editable-array-example-razor.html" class="example-link">Razor Example</a>
          <a href="ck-editable-array-example-react.html" class="example-link">React Example</a>
          <a href="ck-editable-array-example-angular.html" class="example-link">Angular Example</a>
        </p>

        <h3>Quick Inline Example</h3>
        <div class="alert alert-info">
          <strong>Minimal Usage:</strong> Add just a few lines to get started.
        </div>
        <pre><code>&lt;ck-editable-array id="demo"&gt;
  &lt;template data-slot="display"&gt;
    &lt;span data-bind="text"&gt;&lt;/span&gt;
    &lt;button data-action="toggle"&gt;Edit&lt;/button&gt;
  &lt;/template&gt;
  &lt;template data-slot="edit"&gt;
    &lt;input data-bind="text"&gt;
    &lt;button data-action="save"&gt;Save&lt;/button&gt;
    &lt;button data-action="cancel"&gt;Cancel&lt;/button&gt;
  &lt;/template&gt;
&lt;/ck-editable-array&gt;

&lt;script&gt;
  demo.data = [{ text: 'Hello' }];
  demo.newItemFactory = () => ({ text: '' });
&lt;/script&gt;</code></pre>
      </section>

      <!-- Accessibility -->
      <section id="accessibility">
        <h2>Accessibility</h2>
        <p>
          The component is built with accessibility in mind and includes comprehensive ARIA support:
        </p>

        <h3>ARIA Attributes</h3>
        <ul>
          <li><strong>Semantic Roles:</strong> The component container uses <code>role="list"</code> and each row uses <code>role="listitem"</code></li>
          <li><strong>Labels:</strong> Action buttons receive auto-generated <code>aria-label</code> attributes (e.g., "Edit item 1", "Save item 2")</li>
          <li><strong>Form Fields:</strong> Inputs without visible labels get <code>aria-label</code> attributes based on the bound field name</li>
          <li><strong>Validation State:</strong> Invalid fields receive <code>aria-invalid="true"</code> and <code>aria-describedby</code> pointing to error messages</li>
          <li><strong>Modal Dialog:</strong> Modal uses <code>role="dialog"</code> and <code>aria-modal="true"</code></li>
        </ul>

        <h3>Keyboard Navigation</h3>
        <ul>
          <li>All actions are accessible via keyboard (Tab, Enter, Escape)</li>
          <li>Focus management: Focus returns to the edit button after save/cancel operations</li>
          <li>Modal closes on Escape key (via standard dialog behavior)</li>
        </ul>

        <h3>Screen Reader Support</h3>
        <p>
          The component announces state changes and validation errors to screen readers through ARIA live regions
          and proper labeling.
        </p>

        <h3>Best Practices</h3>
        <ul>
          <li>Always provide meaningful labels for custom buttons in your templates</li>
          <li>Use the <code>data-label</code> attribute on inputs to override auto-generated labels: <code>&lt;input data-bind="firstName" data-label="First name"&gt;</code></li>
          <li>Include visible labels or use <code>aria-label</code> for all form controls</li>
          <li>Test with screen readers (NVDA, JAWS, VoiceOver) for your specific use case</li>
        </ul>
      </section>

      <!-- FAQ -->
      <section id="faq">
        <h2>FAQ</h2>

        <h3>Can I edit multiple rows at once?</h3>
        <p>
          No, the component enforces a single-row editing mode to prevent conflicting edits and maintain data integrity.
        </p>

        <h3>How do I handle nested object properties?</h3>
        <p>
          Use dot notation in the <code>data-bind</code> attribute: <code>&lt;span data-bind="user.address.city"&gt;&lt;/span&gt;</code>
        </p>

        <h3>Can I customize the delete behavior?</h3>
        <p>
          The component uses soft delete by default (sets <code>deleted: true</code>). To implement hard delete,
          listen to the <code>datachanged</code> event and filter out deleted items before saving to your backend.
        </p>

        <h3>Does it work with TypeScript?</h3>
        <p>
          Yes, full TypeScript definitions are included in the package at <code>dist/index.d.ts</code>.
        </p>

        <h3>How do I style the templates?</h3>
        <p>
          Include a <code>&lt;link rel="stylesheet"&gt;</code> or <code>&lt;style&gt;</code> tag at the top of your template.
          The template content is inserted into the Shadow DOM, so global styles won't affect it.
        </p>

        <h3>Can I use it with forms?</h3>
        <p>
          Yes, the component generates proper <code>name</code> and <code>id</code> attributes for form inputs
          based on the component's <code>name</code> attribute. For example, if the component name is "users" and you have
          a field bound to "email" at index 0, the input will have <code>name="users[0].email"</code>.
        </p>

        <h3>What browsers are supported?</h3>
        <p>
          The component works in all modern browsers that support Custom Elements (Chrome, Firefox, Safari, Edge).
          For older browsers, you'll need to include polyfills.
        </p>

        <h3>How do I programmatically trigger edit mode?</h3>
        <p>
          The component doesn't expose public methods for entering edit mode. Use action buttons with <code>data-action="toggle"</code>
          in your templates. If you need programmatic control, you can simulate a click on the toggle button or
          dispatch a custom event that your template responds to.
        </p>
      </section>

      <footer style="margin-top: 4rem; padding-top: 2rem; border-top: 1px solid #ecf0f1; color: #7f8c8d;">
        <p>&copy; 2024 ck-webcomponents. Licensed under MIT. |
          <a href="https://github.com/ColmKenna/ckWebComponents" style="color: #3498db;">GitHub Repository</a>
        </p>
      </footer>
    </main>
  </div>

  <script>
    // Smooth scrolling for anchor links
    document.querySelectorAll('.sidebar a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);

        if (targetElement) {
          targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });

          // Update active state
          document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
          this.classList.add('active');
        }
      });
    });

    // Update active link on scroll
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.sidebar a[href^="#"]');

    function updateActiveLink() {
      let current = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (window.pageYOffset >= sectionTop - 100) {
          current = section.getAttribute('id');
        }
      });

      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === `#${current}`) {
          link.classList.add('active');
        }
      });
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
  </script>
</body>
</html>